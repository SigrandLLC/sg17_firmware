#!/bin/sh

. /etc/templates/lib
key=$1
zoneid=$2

zonedata=`kdb get $key`
eval "$zonedata"

admin=`echo $admin | sed s/@/./`
echo ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"
echo ";;;;;"
echo ";;;;;  This file automatically generated by $0 at $(date '+%Y%m%d %H:%M:%S')"
echo ";;;;;  Do not edit it by hands, please use webface, kdb or edit $0"
echo ";;;;;"
echo ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"
echo 
echo "\$ORIGIN $zone."
echo "\$TTL $ttl"
echo
echo "@       IN  SOA $nameserver  $admin. ("
echo "			$serial ; serial"
echo "			$refresh ; refresh"
echo "			$retry ; retry"
echo "			$expire ; expire"
echo "			$ttl ; default ttl"
echo "			)"
echo 

for k in `kdb kls svc_dns_zone_${zoneid}_*`; do
	val=`kdb get $k`
	eval "$val"
	echo "$domain		IN	$datatype	$prio		$data"
done
