--- sercd-3.0.0/sercd.c.orig	2010-03-24 18:09:48.000000000 +0600
+++ sercd-3.0.0/sercd.c	2010-03-24 19:37:44.000000000 +0600
@@ -242,7 +242,7 @@ void
 InitTelnetStateMachine(void)
 {
     int i;
-    for (i = 0; i < 256; i++) {
+    for (i = 0; i < sizeof(tnstate) / sizeof(tnstate[0]) ; i++) {
 	tnstate[i].sent_do = 0;
 	tnstate[i].sent_will = 0;
 	tnstate[i].sent_wont = 0;
