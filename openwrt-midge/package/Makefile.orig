# Main makefile for the packages
include $(TOPDIR)/rules.mk

package-$(BR2_PACKAGE_6TUNNEL) += 6tunnel
package-$(BR2_PACKAGE_AICCU) += aiccu
package-$(BR2_PACKAGE_AIRCRACK) += aircrack
package-$(BR2_PACKAGE_AMWALL) += amwall
package-$(BR2_PACKAGE_ARPD) += arpd
package-$(BR2_PACKAGE_ARPTABLES) += arptables
package-$(BR2_PACKAGE_ARPWATCH) += arpwatch
package-$(BR2_PACKAGE_ASTERISK) += asterisk
package-$(BR2_COMPILE_ATFTP) += atftp
package-$(BR2_COMPILE_AVAHI) += avahi
package-$(BR2_COMPILE_BC) += bc
package-$(BR2_COMPILE_BIND) += bind
package-$(BR2_PACKAGE_BLUEZ_LIBS) += bluez-libs
package-$(BR2_PACKAGE_BLUEZ_UTILS) += bluez-utils
package-$(BR2_PACKAGE_BRIDGE) += bridge
package-$(BR2_PACKAGE_BUSYBOX) += busybox
package-$(BR2_PACKAGE_BWM) += bwm
package-$(BR2_PACKAGE_CGILIB) += cgilib
package-$(BR2_PACKAGE_CHILLISPOT) += chillispot
package-$(BR2_PACKAGE_CIFSMOUNT) += cifsmount
package-$(BR2_PACKAGE_CLINKC) += clinkc
package-$(BR2_PACKAGE_COLLECTD) += collectd
package-$(BR2_PACKAGE_CUPS) += cups
package-$(BR2_COMPILE_CURL) += curl
package-$(BR2_PACKAGE_CUTTER) += cutter
package-$(BR2_COMPILE_CYRUS_SASL) += cyrus-sasl
package-$(BR2_COMPILE_DB) += libdb
package-$(BR2_PACKAGE_DECO) += deco
package-$(BR2_COMPILE_DHCP) += dhcp
package-$(BR2_PACKAGE_DHCP6) += dhcp6
package-$(BR2_PACKAGE_DHCP_FORWARDER) += dhcp-forwarder
package-$(BR2_PACKAGE_DNSMASQ) += dnsmasq
package-$(BR2_PACKAGE_DOSFSTOOLS) += dosfstools
package-$(BR2_PACKAGE_DROPBEAR) += dropbear
package-$(BR2_PACKAGE_DSNIFF) += dsniff
package-$(BR2_PACKAGE_E2FSPROGS) += e2fsprogs
package-$(BR2_PACKAGE_EBTABLES) += ebtables
package-$(BR2_PACKAGE_ETHER_WAKE) += ether-wake
package-$(BR2_COMPILE_EXPAT) += expat
package-$(BR2_PACKAGE_EZIPUPDATE) += ez-ipupdate
package-$(BR2_COMPILE_FLAC) += flac
package-$(BR2_PACKAGE_FPING) += fping
package-$(BR2_PACKAGE_FPROBE) += fprobe
package-$(BR2_PACKAGE_FPROBE_ULOG) += fprobe-ulog
package-$(BR2_PACKAGE_FREERADIUS) += freeradius
package-$(BR2_COMPILE_FREETYPE) += freetype
package-$(BR2_PACKAGE_FRICKIN) += frickin
package-$(BR2_COMPILE_FUSE) += fuse
package-$(BR2_PACKAGE_GDBSERVER) += gdbserver
package-$(BR2_COMPILE_GLIB) += glib
package-$(BR2_PACKAGE_GMEDIASERVER) += gmediaserver
package-$(BR2_COMPILE_GMP) += gmp
package-$(BR2_COMPILE_GNUTLS) += gnutls
package-$(BR2_PACKAGE_GPSD) += gpsd
package-$(BR2_COMPILE_GSM) += gsm
package-$(BR2_PACKAGE_HASERL) += haserl
package-$(BR2_PACKAGE_HEYU) += heyu
package-$(BR2_PACKAGE_HOSTAP_UTILS) += hostap-utils
package-$(BR2_PACKAGE_HOSTAPD) += hostapd
package-$(BR2_COMPILE_HOWL) += howl
package-$(BR2_PACKAGE_HTPDATE) += htpdate
package-$(BR2_PACKAGE_ICECAST) += icecast
package-$(BR2_PACKAGE_ID3LIB) += id3lib
package-$(BR2_PACKAGE_IPCAD) += ipcad
package-$(BR2_PACKAGE_IPERF) += iperf
package-$(BR2_PACKAGE_IPKG) += ipkg
package-$(BR2_COMPILE_IPROUTE2) += iproute2
package-$(BR2_PACKAGE_IPSEC_TOOLS) += ipsec-tools
package-$(BR2_PACKAGE_IPSET) += ipset
package-$(BR2_COMPILE_IPTABLES) += iptables
package-$(BR2_PACKAGE_IPTABLES_SNMP) += iptables-snmp
package-$(BR2_PACKAGE_IPTRAF) += iptraf
package-$(BR2_PACKAGE_IRSSI) += irssi
package-$(BR2_COMPILE_JPEG) += jpeg
package-$(BR2_COMPILE_KISMET) += kismet
package-$(BR2_COMPILE_KNOCK) += knock
package-$(BR2_PACKAGE_L2TPD) += l2tpd
package-$(BR2_PACKAGE_L2TPNS) += l2tpns
package-$(BR2_PACKAGE_LCD4LINUX) += lcd4linux
package-$(BR2_PACKAGE_LESS) += less
package-$(BR2_PACKAGE_LIBAMSEL) += libamsel
package-$(BR2_PACKAGE_LIBAO) += libao
package-$(BR2_PACKAGE_LIBART) += libart
package-$(BR2_PACKAGE_LIBCLI) += libcli
package-$(BR2_PACKAGE_LIBDAEMON) += libdaemon
package-$(BR2_PACKAGE_LIBDNET) += libdnet
package-$(BR2_PACKAGE_LIBELF) += libelf
package-$(BR2_PACKAGE_LIBEVENT) += libevent
package-$(BR2_PACKAGE_LIBFFI_SABLE) += libffi-sable
package-$(BR2_PACKAGE_LIBGCRYPT) += libgcrypt
package-$(BR2_PACKAGE_LIBGD) += libgd
package-$(BR2_PACKAGE_LIBGDBM) += libgdbm
package-$(BR2_PACKAGE_LIBGPG_ERROR) += libgpg-error
package-$(BR2_PACKAGE_LIBID3TAG) += libid3tag
package-$(BR2_PACKAGE_LIBLZO) += liblzo
package-$(BR2_PACKAGE_LIBMAD) += libmad
package-$(BR2_PACKAGE_LIBNET) += libnet
package-$(BR2_PACKAGE_LIBNIDS) += libnids
package-$(BR2_PACKAGE_LIBOGG) += libogg
package-$(BR2_PACKAGE_LIBOSIP2) += libosip2
package-$(BR2_PACKAGE_LIBPCAP) += libpcap
package-$(BR2_PACKAGE_LIBPNG) += libpng
package-$(BR2_PACKAGE_LIBPTHREAD) += libpthread
package-$(BR2_PACKAGE_LIBTASN1) += libtasn1
package-$(BR2_COMPILE_LIBTOOL) += libtool
package-$(BR2_PACKAGE_LIBUPNP) += libupnp
package-$(BR2_PACKAGE_LIBUSB) += libusb
package-$(BR2_PACKAGE_LIBVORBIS) += libvorbis
package-$(BR2_PACKAGE_LIBVORBISIDEC) += libvorbisidec
package-$(BR2_PACKAGE_LIBWRAP) += tcp_wrappers
package-$(BR2_PACKAGE_LIBXML2) += libxml2
package-$(BR2_PACKAGE_LIBXSLT) += libxslt
package-$(BR2_PACKAGE_LIGHTTPD) += lighttpd
package-$(BR2_PACKAGE_LINUX_ATM) += linux-atm
package-$(BR2_PACKAGE_LRZSZ) += lrzsz
package-$(BR2_COMPILE_LUA) += lua
package-$(BR2_PACKAGE_MACCHANGER) += macchanger
package-$(BR2_PACKAGE_MADPLAY) += madplay
package-$(BR2_PACKAGE_MARADNS) += maradns
package-$(BR2_COMPILE_MATRIXSSL) += matrixssl
package-$(BR2_PACKAGE_MIAX) += miax
package-$(BR2_PACKAGE_MICROCOM) += microcom
package-$(BR2_PACKAGE_MICROPERL) += microperl
package-$(BR2_COMPILE_MINI_HTTPD) += mini_httpd
package-$(BR2_PACKAGE_MINI_SENDMAIL) += mini_sendmail
package-$(BR2_COMPILE_MIREDO) += miredo
package-$(BR2_COMPILE_MONIT) += monit
package-$(BR2_PACKAGE_MPD) += mpd
package-$(BR2_PACKAGE_MRD6) += mrd6
package-$(BR2_PACKAGE_MT_DAAPD) += mt-daapd
package-$(BR2_PACKAGE_MTD) += mtd
package-$(BR2_PACKAGE_MTR) += mtr
package-$(BR2_COMPILE_MYSQL) += mysql
package-$(BR2_PACKAGE_NANO) += nano
package-$(BR2_COMPILE_NCURSES) += ncurses
package-$(BR2_COMPILE_NDISC6) += ndisc
package-$(BR2_COMPILE_NET_SNMP) += net-snmp
package-$(BR2_PACKAGE_NETPERF) += netperf
package-$(BR2_PACKAGE_NETSTAT_NAT) += netstat-nat
package-$(BR2_PACKAGE_NFS_SERVER) += nfs-server
package-$(BR2_PACKAGE_NMAP) += nmap
package-$(BR2_PACKAGE_NOCATSPLASH) += nocatsplash
package-$(BR2_PACKAGE_NTPCLIENT) += ntpclient
package-$(BR2_PACKAGE_NVRAM) += nvram
package-$(BR2_PACKAGE_OLSRD) += olsrd
package-$(BR2_COMPILE_OPENCDK) += opencdk
package-$(BR2_COMPILE_OPENLDAP) += openldap
package-$(BR2_PACKAGE_OPENNTPD) += openntpd
package-$(BR2_PACKAGE_OPENSER) += openser
package-$(BR2_COMPILE_OPENSSH) += openssh
package-$(BR2_COMPILE_OPENSSL) += openssl
package-$(BR2_PACKAGE_OPENSWAN) += openswan
package-$(BR2_PACKAGE_OPENVPN) += openvpn
package-$(BR2_COMPILE_OSIRIS) += osiris
package-$(BR2_PACKAGE_PALANTIR) += palantir
package-$(BR2_PACKAGE_P910ND) += p910nd
package-$(BR2_PACKAGE_PARPROUTED) += parprouted
package-$(BR2_COMPILE_PCMCIA_CS) += pcmcia-cs
package-$(BR2_COMPILE_PCRE) += pcre
package-$(BR2_PACKAGE_PEERCAST) += peercast
package-$(BR2_PACKAGE_PEERGUARDIAN) += peerguardian
package-$(BR2_COMPILE_PHP4) += php4
package-$(BR2_COMPILE_PHP5) += php5
package-$(BR2_PACKAGE_PICOCOM) += picocom
package-$(BR2_PACKAGE_PIPACS) += pipacs
package-$(BR2_COMPILE_PMACCT) += pmacct
package-$(BR2_COMPILE_POPT) += popt
package-$(BR2_PACKAGE_PORTMAP) += portmap
package-$(BR2_PACKAGE_PORTSENTRY) += portsentry
package-$(BR2_COMPILE_POSTGRESQL) += postgresql
package-$(BR2_PACKAGE_PPP) += ppp
package-$(BR2_PACKAGE_PPTP) += pptp
package-$(BR2_PACKAGE_PPTPD) += pptpd
package-$(BR2_PACKAGE_PSYBNC) += psybnc
package-$(BR2_PACKAGE_PTUNNEL) += ptunnel
package-$(BR2_PACKAGE_QUAGGA) += quagga
package-$(BR2_PACKAGE_RADVD) += radvd
package-$(BR2_PACKAGE_RARPD) += rarpd
package-$(BR2_COMPILE_READLINE) += readline
package-$(BR2_PACKAGE_REAIM) += reaim
package-$(BR2_PACKAGE_ROBOCFG) += robocfg
package-$(BR2_COMPILE_RP_PPPOE) += rp-pppoe
package-$(BR2_PACKAGE_RRDCOLLECT) += rrdcollect
package-$(BR2_COMPILE_RRDTOOL) += rrdtool
package-$(BR2_COMPILE_RRDTOOL1) += rrdtool1
package-$(BR2_COMPILE_RRS) += rrs
package-$(BR2_PACKAGE_RSYNC) += rsync
package-$(BR2_PACKAGE_SABLEVM) += sablevm
package-$(BR2_COMPILE_SABLEVM_CLASSPATH) += sablevm-classpath
package-$(BR2_COMPILE_SAMBA) += samba
package-$(BR2_PACKAGE_SANE_BACKENDS) += sane-backends
package-$(BR2_PACKAGE_SCDP) += scdp
package-$(BR2_PACKAGE_SCREEN) += screen
package-$(BR2_PACKAGE_SDK) += sdk
package-$(BR2_PACKAGE_SERDISPLIB) += serdisplib
package-$(BR2_PACKAGE_SETPWC) += setpwc
package-$(BR2_PACKAGE_SETSERIAL) += setserial
package-$(BR2_PACKAGE_SHAT) += shat
package-$(BR2_COMPILE_SHFS) += shfs
package-$(BR2_PACKAGE_SIPROXD) += siproxd
package-$(BR2_PACKAGE_SIPSAK) += sipsak
package-$(BR2_PACKAGE_SLURM) += slurm
package-$(BR2_COMPILE_SNORT) += snort
package-$(BR2_COMPILE_SNORT_WIRELESS) += snort-wireless
package-$(BR2_PACKAGE_SOCAT) += socat
package-$(BR2_COMPILE_SPEEX) += speex
package-$(BR2_COMPILE_SQLITE) += sqlite
package-$(BR2_COMPILE_SQLITE2) += sqlite2
package-$(BR2_PACKAGE_SSMTP) += ssmtp
package-$(BR2_PACKAGE_SSLTUNNEL) += ssltunnel
package-$(BR2_PACKAGE_SRELAY) += srelay
package-$(BR2_PACKAGE_STRACE) += strace
package-$(BR2_PACKAGE_TCPDUMP) += tcpdump
package-$(BR2_PACKAGE_TINC) += tinc
package-$(BR2_PACKAGE_TINYPROXY) += tinyproxy
package-$(BR2_PACKAGE_TOR) += tor
package-$(BR2_PACKAGE_TTCP) += ttcp
package-$(BR2_PACKAGE_UCLIBCXX) += uclibc++
package-$(BR2_PACKAGE_UDP_BROADCAST_RELAY) += udp-broadcast-relay
package-$(BR2_PACKAGE_ULOGD) += ulogd
package-$(BR2_PACKAGE_UPDATEDD) += updatedd
package-$(BR2_COMPILE_USBUTILS) += usbutils
package-$(BR2_PACKAGE_USTL) += ustl
package-$(BR2_COMPILE_UTIL_LINUX) += util-linux
package-$(BR2_PACKAGE_UDEV) += udev
package-$(BR2_PACKAGE_VGP) += vgp
package-$(BR2_PACKAGE_VNC_REFLECTOR) += vnc-reflector
package-$(BR2_PACKAGE_VNSTAT) += vnstat
package-$(BR2_PACKAGE_VPNC) += vpnc
package-$(BR2_PACKAGE_VRRPD) += vrrpd
package-$(BR2_PACKAGE_VTUN) += vtun
package-$(BR2_PACKAGE_VSFTPD) += vsftpd
package-$(BR2_PACKAGE_WATCHDOG) += watchdog
package-$(BR2_PACKAGE_WCCPD) += wccpd
package-$(BR2_PACKAGE_WIFICONF) += wificonf
package-$(BR2_PACKAGE_WIFIDOG) += wifidog
package-$(BR2_PACKAGE_WIVIZ) += wiviz
package-$(BR2_PACKAGE_WIRELESS_TOOLS) += wireless-tools
package-$(BR2_PACKAGE_WKNOCK) += wknock
package-$(BR2_PACKAGE_WOL) += wol
package-$(BR2_PACKAGE_WONDERSHAPER) += wondershaper
package-$(BR2_PACKAGE_WPA_SUPPLICANT) += wpa_supplicant
package-$(BR2_PACKAGE_WPUT) += wput
package-$(BR2_PACKAGE_WRT_RADAUTH) += wrt-radauth
package-$(BR2_PACKAGE_WX200D) += wx200d
package-$(BR2_PACKAGE_XINETD) += xinetd
package-$(BR2_PACKAGE_XSUPPLICANT) += xsupplicant
package-$(BR2_PACKAGE_ZLIB) += zlib

DEV_LIBS:=tcp_wrappers glib ncurses openssl pcre popt zlib libnet libpcap mysql postgresql iptables matrixssl liblzo gmp fuse portmap libelf uclibc++ speex libpng libgd wireless-tools nvram linux-atm libamsel libao libart libdaemon libdb libdnet libevent libffi-sable libgcrypt libgdbm libgpg-error libid3tag libmad libnet libnids libogg libosip2 libpcap libtasn1 libupnp libusb libvorbis libvorbisidec libxml2 libxslt id3lib
DEV_LIBS_COMPILE:=$(patsubst %,%-compile,$(DEV_LIBS))
SDK_DEFAULT_PACKAGES:=busybox dnsmasq iptables wireless-tools dropbear bridge ipkg ppp
SDK_DEFAULT_COMPILE:=$(patsubst %,%-compile,$(SDK_DEFAULT_PACKAGES))
COMPILE_PACKAGES:=$(patsubst %,%-compile,$(package-y) $(package-m))
INSTALL_PACKAGES:=$(patsubst %,%-install,$(package-y))

all: compile
clean: $(patsubst %,%-clean,$(package-) $(package-y) $(package-m))
compile: $(COMPILE_PACKAGES)
install: base-files-install $(INSTALL_PACKAGES)

$(COMPILE_PACKAGES): base-files-compile
$(INSTALL_PACKAGES): base-files-install

amwall-compile: libamsel-compile
arpd-compile: libpcap-compile libdnet-compile libevent-compile
arpwatch-compile: libpcap-compile
atftp-compile: readline-compile
avahi-compile: libdaemon-compile expat-compile libgdbm-compile
bind-compile: openssl-compile
clinkc-compile: expat-compile
curl-compile: openssl-compile zlib-compile
cyrus-sasl-compile: openssl-compile
deco-compile: ncurses-compile
dhcp6-compile: ncurses-compile
dropbear-compile: zlib-compile
dsniff-compile: libnids-compile openssl-compile libgdbm-compile
freetype-compile: zlib-compile
fprobe-compile: libpcap-compile
gdbserver-compile: ncurses-compile
gmediaserver-compile: id3lib-compile libupnp-compile
gnutls-compile: libgcrypt-compile opencdk-compile libtasn1-compile
gpsd-compile: uclibc++-compile
icecast-compile: curl-compile libvorbisidec-compile libxml2-compile libxslt-compile
id3lib-compile: uclibc++-compile zlib-compile
ipcad-compile: libpcap-compile
irssi-compile: glib-compile ncurses-compile
iperf-compile: uclibc++-compile
iptables-snmp-compile: net-snmp-compile
iptraf-compile: ncurses-compile
hostapd-compile: openssl-compile wireless-tools-compile
kismet-compile: uclibc++-compile libpcap-compile ncurses-compile
l2tpns-compile: libcli-compile
less-compile: ncurses-compile
lcd4linux-compile: ncurses-compile
libgcrypt-compile: libgpg-error-compile
libgd-compile: libpng-compile
libid3tag-compile: zlib-compile
libnet-compile: libpcap-compile
libnids-compile: libnet-compile
libvorbis-compile: libogg-compile
libxml2-compile: zlib-compile
libxslt-compile: libxml2-compile
lighttpd-compile: openssl-compile pcre-compile
madplay-compile: libid3tag-compile libmad-compile
miax-compile: bluez-libs-compile
miredo-compile: uclibc++-compile
monit-compile: openssl-compile
mt-daapd-compile: howl-compile libgdbm-compile libid3tag-compile
mtr-compile: ncurses-compile
mysql-compile: ncurses-compile zlib-compile readline-compile
nano-compile: ncurses-compile
net-snmp-compile: libelf-compile
nfs-server-compile: portmap-compile
nmap-compile: uclibc++-compile pcre-compile libpcap-compile
nocatsplash-compile: glib-compile
opencdk-compile: libgcrypt-compile
openldap-compile: cyrus-sasl-compile openssl-compile
openssh-compile: zlib-compile openssl-compile
openssl-compile: zlib-compile
openswan-compile: gmp-compile
osiris-compile: openssl-compile
palantir-compile: jpeg-compile
peercast-compile: uclibc++-compile
peerguardian-compile: libpthread-compile
portmap-compile: tcp_wrappers-compile
postgresql-compile: zlib-compile
ppp-compile: linux-atm-compile
ptunnel-compile: libpcap-compile
quagga-compile: readline-compile ncurses-compile
raddump-compile: openssl-compile libpcap-compile
rarpd-compile: libnet-compile
ifneq ($(BR2_PACKAGE_LIBRRD),)
rrdcollect-compile: rrdtool-compile
endif
ifneq ($(BR2_PACKAGE_LIBRRD1),)
rrdcollect-compile: rrdtool1-compile
endif
rrdtool-compile: cgilib-compile freetype-compile libart-compile libpng-compile
rrdtool1-compile: zlib-compile
rsync-compile: popt-compile
scdp-compile: libnet-compile
screen-compile: ncurses-compile
siproxd-compile: libosip2-compile
sipsak-compile: openssl-compile
socat-compile: openssl-compile
sqlite-compile: ncurses-compile readline-compile
sqlite2-compile: ncurses-compile readline-compile
ssltunnel-compile: openssl-compile ppp-compile
tcpdump-compile: libpcap-compile
tinc-compile: zlib-compile openssl-compile liblzo-compile
tor-compile: libevent-compile openssl-compile zlib-compile
usbutils-compile: libusb-compile
vnc-reflector-compile: jpeg-compile zlib-compile
vpnc-compile: libgcrypt-compile libgpg-error-compile
vtun-compile: zlib-compile openssl-compile liblzo-compile
wificonf-compile: wireless-tools-compile nvram-compile
wiviz-compile: libpcap-compile
wknock-compile: libpcap-compile
wpa_supplicant-compile: openssl-compile
wx200d-compile: postgresql-compile
xsupplicant-compile: openssl-compile
ipsec-tools-compile: openssl-compile

asterisk-compile: bluez-libs-compile ncurses-compile openssl-compile
ifneq ($(BR2_PACKAGE_ASTERISK_CODEC_SPEEX),)
asterisk-compile: speex-compile
endif
ifneq ($(BR2_PACKAGE_ASTERISK_PGSQL),)
asterisk-compile: postgresql-compile
endif
ifneq ($(BR2_PACKAGE_ASTERISK_MYSQL),)
asterisk-compile: mysql-compile
endif
ifneq ($(BR2_PACKAGE_ASTERISK_SQLITE),)
asterisk-compile: sqlite2-compile
endif

freeradius-compile: libtool-compile openssl-compile
ifneq ($(BR2_PACKAGE_FREERADIUS_MOD_LDAP),)
freeradius-compile: openldap-compile
endif
ifneq ($(BR2_PACKAGE_FREERADIUS_MOD_SQL_MYSQL),)
freeradius-compile: mysql-compile
endif
ifneq ($(BR2_PACKAGE_FREERADIUS_MOD_SQL_PGSQL),)
freeradius-compile: postgresql-compile
endif

ifneq ($(BR2_PACKAGE_MINI_HTTPD_MATRIXSSL),)
mini_httpd-compile: matrixssl-compile
endif
ifneq ($(BR2_PACKAGE_MINI_HTTPD_OPENSSL),)
mini_httpd-compile: openssl-compile
endif

ifneq ($(BR2_PACKAGE_MPD_MP3),)
mpd-compile: libid3tag-compile libmad-compile
endif
ifneq ($(BR2_PACKAGE_MPD_OGG),)
mpd-compile: libvorbisidec-compile
endif
ifneq ($(BR2_PACKAGE_MPD_FLAC),)
mpd-compile: flac-compile
endif

openvpn-compile: openssl-compile
ifeq ($(BR2_PACKAGE_OPENVPN_LZO),y)
openvpn-compile: liblzo-compile
endif

php4-compile: openssl-compile zlib-compile
ifneq ($(BR2_PACKAGE_PHP4_MOD_CURL),)
php4-compile: curl-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_GD),)
php4-compile: libgd-compile libpng-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_GMP),)
php4-compile: gmp-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_LDAP),)
php4-compile: openldap-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_MYSQL),)
php4-compile: mysql-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_PCRE),)
php4-compile: pcre-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_PGSQL),)
php4-compile: postgresql-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_SQLITE),)
php4-compile: sqlite2-compile
endif
ifneq ($(BR2_PACKAGE_PHP4_MOD_XML),)
php4-compile: expat-compile
endif

php5-compile: openssl-compile zlib-compile
ifneq ($(BR2_PACKAGE_PHP5_MOD_CURL),)
php5-compile: curl-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_GD),)
php5-compile: libgd-compile libpng-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_GMP),)
php5-compile: gmp-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_LDAP),)
php5-compile: openldap-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_MYSQL),)
php5-compile: mysql-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_PCRE),)
php5-compile: pcre-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_PGSQL),)
php5-compile: postgresql-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_SQLITE),)
php5-compile: sqlite2-compile
endif
ifneq ($(BR2_PACKAGE_PHP5_MOD_XML),)
php5-compile: expat-compile
endif

pmacct-compile: libpcap-compile
ifneq ($(BR2_COMPILE_PMACCT_MYSQL),)
pmacct-compile: mysql-compile
endif
ifneq ($(BR2_COMPILE_PMACCT_PGSQL),)
pmacct-compile: postgresql-compile
endif

rrs-compile: uclibc++-compile
ifneq ($(BR2_PACKAGE_RRS),)
rrs-compile: openssl-compile
endif

snort-compile: libnet-compile libpcap-compile pcre-compile
ifeq ($(BR2_PACKAGE_SNORT_WITH_MYSQL),y)
snort-compile: mysql-compile
endif
ifeq ($(BR2_PACKAGE_SNORT_WITH_PGSQL),y)
snort-compile: postgresql-compile
endif
ifeq ($(BR2_PACKAGE_SNORT_ENABLE_INLINE),y)
snort-compile: iptables-compile
endif

snort-wireless-compile: libnet-compile libpcap-compile pcre-compile
ifeq ($(BR2_PACKAGE_SNORT_WIRELESS_WITH_MYSQL),y)
snort-wireless-compile: mysql-compile
endif
ifeq ($(BR2_PACKAGE_SNORT_WIRELESS_WITH_PGSQL),y)
snort-wireless-compile: postgresql-compile
endif
ifeq ($(BR2_PACKAGE_SNORT_WIRELESS_ENABLE_INLINE),y)
snort-wireless-compile: iptables-compile
endif

ulogd-compile: iptables-compile
ifneq ($(BR2_PACKAGE_ULOGD_MOD_MYSQL),)
ulogd-compile: mysql-compile
endif
ifneq ($(BR2_PACKAGE_ULOGD_MOD_PGSQL),)
ulogd-compile: postgresql-compile
endif

sdk-compile: $(DEV_LIBS_COMPILE) $(SDK_DEFAULT_COMPILE)

$(STAMP_DIR):
	mkdir -p $@

$(TARGET_DIR):
	mkdir -p $(TARGET_DIR)

%-prepare: $(STAMP_DIR) $(TARGET_DIR)
	@[ -f $(STAMP_DIR)/.$@ ] || { \
		$(START_TRACE) "package/$(patsubst %-prepare,%,$@)-prepare: "; \
		$(MAKE) -C $(patsubst %-prepare,%,$@) prepare && { \
			touch $(STAMP_DIR)/.$@; \
			$(CMD_TRACE) " done"; \
			$(END_TRACE); \
		} \
	}

%-compile:
	@[ -f $(STAMP_DIR)/.$@ ] || { \
		$(START_TRACE) "package/$(patsubst %-compile,%,$@)-compile: "; \
		$(MAKE) -C $(patsubst %-compile,%,$@) compile && { \
			touch $(STAMP_DIR)/.$(patsubst %-compile,%,$@)-prepare; \
			touch $(STAMP_DIR)/.$@; \
			$(CMD_TRACE) " done"; \
			$(END_TRACE); \
		} \
	}

%-install: %-compile
	@$(START_TRACE) "package/$(patsubst %-install,%,$@)-install: "
	@$(MAKE) -C $(patsubst %-install,%,$@) install
	@$(CMD_TRACE) " done"
	@$(END_TRACE)

%-rebuild: 
	@$(START_TRACE) "package/$(patsubst %-rebuild,%,$@)-rebuild: "
	@rm -f $(STAMP_DIR)/.$(patsubst %-rebuild,%,$@)-*
	$(MAKE) -C $(patsubst %-rebuild,%,$@) rebuild
	@$(CMD_TRACE) " done"
	@$(END_TRACE)

%-clean:
	@$(START_TRACE) "package/$(patsubst %-clean,%,$@)-clean: "
	@$(MAKE) -C $(patsubst %-clean,%,$@) clean
	@rm -f $(STAMP_DIR)/.$(patsubst %-clean,%,$@)-*
	@$(CMD_TRACE) " done"
	@$(END_TRACE)

